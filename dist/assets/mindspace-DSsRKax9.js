import{L as se,F as ie,b as $,c as re,G as ae,d as B,e as z,f as T,g as Y,h as C,i as le,j as q,k as G,a as _,V as x,S as ce,P as de,W as ue,A as he,D as fe,R as me,l as pe,m as ee,M as H,B as k,n as ge}from"./three.module-8Oc40bl9.js";const ye=/^[og]\s*(.+)?/,we=/^mtllib /,ve=/^usemtl /,be=/^usemap /,X=/\s+/,K=new x,J=new x,Q=new x,Z=new x,M=new x,R=new $;function xe(){const i={objects:[],object:{},vertices:[],normals:[],colors:[],uvs:[],materials:{},materialLibraries:[],startObject:function(e,n){if(this.object&&this.object.fromDeclaration===!1){this.object.name=e,this.object.fromDeclaration=n!==!1;return}const t=this.object&&typeof this.object.currentMaterial=="function"?this.object.currentMaterial():void 0;if(this.object&&typeof this.object._finalize=="function"&&this.object._finalize(!0),this.object={name:e||"",fromDeclaration:n!==!1,geometry:{vertices:[],normals:[],colors:[],uvs:[],hasUVIndices:!1},materials:[],smooth:!0,startMaterial:function(o,s){const r=this._finalize(!1);r&&(r.inherited||r.groupCount<=0)&&this.materials.splice(r.index,1);const l={index:this.materials.length,name:o||"",mtllib:Array.isArray(s)&&s.length>0?s[s.length-1]:"",smooth:r!==void 0?r.smooth:this.smooth,groupStart:r!==void 0?r.groupEnd:0,groupEnd:-1,groupCount:-1,inherited:!1,clone:function(d){const c={index:typeof d=="number"?d:this.index,name:this.name,mtllib:this.mtllib,smooth:this.smooth,groupStart:0,groupEnd:-1,groupCount:-1,inherited:!1};return c.clone=this.clone.bind(c),c}};return this.materials.push(l),l},currentMaterial:function(){if(this.materials.length>0)return this.materials[this.materials.length-1]},_finalize:function(o){const s=this.currentMaterial();if(s&&s.groupEnd===-1&&(s.groupEnd=this.geometry.vertices.length/3,s.groupCount=s.groupEnd-s.groupStart,s.inherited=!1),o&&this.materials.length>1)for(let r=this.materials.length-1;r>=0;r--)this.materials[r].groupCount<=0&&this.materials.splice(r,1);return o&&this.materials.length===0&&this.materials.push({name:"",smooth:this.smooth}),s}},t&&t.name&&typeof t.clone=="function"){const o=t.clone(0);o.inherited=!0,this.object.materials.push(o)}this.objects.push(this.object)},finalize:function(){this.object&&typeof this.object._finalize=="function"&&this.object._finalize(!0)},parseVertexIndex:function(e,n){const t=parseInt(e,10);return(t>=0?t-1:t+n/3)*3},parseNormalIndex:function(e,n){const t=parseInt(e,10);return(t>=0?t-1:t+n/3)*3},parseUVIndex:function(e,n){const t=parseInt(e,10);return(t>=0?t-1:t+n/2)*2},addVertex:function(e,n,t){const o=this.vertices,s=this.object.geometry.vertices;s.push(o[e+0],o[e+1],o[e+2]),s.push(o[n+0],o[n+1],o[n+2]),s.push(o[t+0],o[t+1],o[t+2])},addVertexPoint:function(e){const n=this.vertices;this.object.geometry.vertices.push(n[e+0],n[e+1],n[e+2])},addVertexLine:function(e){const n=this.vertices;this.object.geometry.vertices.push(n[e+0],n[e+1],n[e+2])},addNormal:function(e,n,t){const o=this.normals,s=this.object.geometry.normals;s.push(o[e+0],o[e+1],o[e+2]),s.push(o[n+0],o[n+1],o[n+2]),s.push(o[t+0],o[t+1],o[t+2])},addFaceNormal:function(e,n,t){const o=this.vertices,s=this.object.geometry.normals;K.fromArray(o,e),J.fromArray(o,n),Q.fromArray(o,t),M.subVectors(Q,J),Z.subVectors(K,J),M.cross(Z),M.normalize(),s.push(M.x,M.y,M.z),s.push(M.x,M.y,M.z),s.push(M.x,M.y,M.z)},addColor:function(e,n,t){const o=this.colors,s=this.object.geometry.colors;o[e]!==void 0&&s.push(o[e+0],o[e+1],o[e+2]),o[n]!==void 0&&s.push(o[n+0],o[n+1],o[n+2]),o[t]!==void 0&&s.push(o[t+0],o[t+1],o[t+2])},addUV:function(e,n,t){const o=this.uvs,s=this.object.geometry.uvs;s.push(o[e+0],o[e+1]),s.push(o[n+0],o[n+1]),s.push(o[t+0],o[t+1])},addDefaultUV:function(){const e=this.object.geometry.uvs;e.push(0,0),e.push(0,0),e.push(0,0)},addUVLine:function(e){const n=this.uvs;this.object.geometry.uvs.push(n[e+0],n[e+1])},addFace:function(e,n,t,o,s,r,l,d,c){const f=this.vertices.length;let a=this.parseVertexIndex(e,f),u=this.parseVertexIndex(n,f),m=this.parseVertexIndex(t,f);if(this.addVertex(a,u,m),this.addColor(a,u,m),l!==void 0&&l!==""){const g=this.normals.length;a=this.parseNormalIndex(l,g),u=this.parseNormalIndex(d,g),m=this.parseNormalIndex(c,g),this.addNormal(a,u,m)}else this.addFaceNormal(a,u,m);if(o!==void 0&&o!==""){const g=this.uvs.length;a=this.parseUVIndex(o,g),u=this.parseUVIndex(s,g),m=this.parseUVIndex(r,g),this.addUV(a,u,m),this.object.geometry.hasUVIndices=!0}else this.addDefaultUV()},addPointGeometry:function(e){this.object.geometry.type="Points";const n=this.vertices.length;for(let t=0,o=e.length;t<o;t++){const s=this.parseVertexIndex(e[t],n);this.addVertexPoint(s),this.addColor(s)}},addLineGeometry:function(e,n){this.object.geometry.type="Line";const t=this.vertices.length,o=this.uvs.length;for(let s=0,r=e.length;s<r;s++)this.addVertexLine(this.parseVertexIndex(e[s],t));for(let s=0,r=n.length;s<r;s++)this.addUVLine(this.parseUVIndex(n[s],o))}};return i.startObject("",!1),i}class te extends se{constructor(e){super(e),this.materials=null}load(e,n,t,o){const s=this,r=new ie(this.manager);r.setPath(this.path),r.setRequestHeader(this.requestHeader),r.setWithCredentials(this.withCredentials),r.load(e,function(l){try{n(s.parse(l))}catch(d){o?o(d):console.error(d),s.manager.itemError(e)}},t,o)}setMaterials(e){return this.materials=e,this}parse(e){const n=new xe;e.indexOf(`\r
`)!==-1&&(e=e.replace(/\r\n/g,`
`)),e.indexOf(`\\
`)!==-1&&(e=e.replace(/\\\n/g,""));const t=e.split(`
`);let o=[];for(let l=0,d=t.length;l<d;l++){const c=t[l].trimStart();if(c.length===0)continue;const f=c.charAt(0);if(f!=="#")if(f==="v"){const a=c.split(X);switch(a[0]){case"v":n.vertices.push(parseFloat(a[1]),parseFloat(a[2]),parseFloat(a[3])),a.length>=7?(R.setRGB(parseFloat(a[4]),parseFloat(a[5]),parseFloat(a[6]),re),n.colors.push(R.r,R.g,R.b)):n.colors.push(void 0,void 0,void 0);break;case"vn":n.normals.push(parseFloat(a[1]),parseFloat(a[2]),parseFloat(a[3]));break;case"vt":n.uvs.push(parseFloat(a[1]),parseFloat(a[2]));break}}else if(f==="f"){const u=c.slice(1).trim().split(X),m=[];for(let h=0,y=u.length;h<y;h++){const w=u[h];if(w.length>0){const b=w.split("/");m.push(b)}}const g=m[0];for(let h=1,y=m.length-1;h<y;h++){const w=m[h],b=m[h+1];n.addFace(g[0],w[0],b[0],g[1],w[1],b[1],g[2],w[2],b[2])}}else if(f==="l"){const a=c.substring(1).trim().split(" ");let u=[];const m=[];if(c.indexOf("/")===-1)u=a;else for(let g=0,h=a.length;g<h;g++){const y=a[g].split("/");y[0]!==""&&u.push(y[0]),y[1]!==""&&m.push(y[1])}n.addLineGeometry(u,m)}else if(f==="p"){const u=c.slice(1).trim().split(" ");n.addPointGeometry(u)}else if((o=ye.exec(c))!==null){const a=(" "+o[0].slice(1).trim()).slice(1);n.startObject(a)}else if(ve.test(c))n.object.startMaterial(c.substring(7).trim(),n.materialLibraries);else if(we.test(c))n.materialLibraries.push(c.substring(7).trim());else if(be.test(c))console.warn('THREE.OBJLoader: Rendering identifier "usemap" not supported. Textures must be defined in MTL files.');else if(f==="s"){if(o=c.split(" "),o.length>1){const u=o[1].trim().toLowerCase();n.object.smooth=u!=="0"&&u!=="off"}else n.object.smooth=!0;const a=n.object.currentMaterial();a&&(a.smooth=n.object.smooth)}else{if(c==="\0")continue;console.warn('THREE.OBJLoader: Unexpected line: "'+c+'"')}}n.finalize();const s=new ae;if(s.materialLibraries=[].concat(n.materialLibraries),!(n.objects.length===1&&n.objects[0].geometry.vertices.length===0)===!0)for(let l=0,d=n.objects.length;l<d;l++){const c=n.objects[l],f=c.geometry,a=c.materials,u=f.type==="Line",m=f.type==="Points";let g=!1;if(f.vertices.length===0)continue;const h=new B;h.setAttribute("position",new z(f.vertices,3)),f.normals.length>0&&h.setAttribute("normal",new z(f.normals,3)),f.colors.length>0&&(g=!0,h.setAttribute("color",new z(f.colors,3))),f.hasUVIndices===!0&&h.setAttribute("uv",new z(f.uvs,2));const y=[];for(let b=0,U=a.length;b<U;b++){const j=a[b],N=j.name+"_"+j.smooth+"_"+g;let p=n.materials[N];if(this.materials!==null){if(p=this.materials.create(j.name),u&&p&&!(p instanceof T)){const D=new T;Y.prototype.copy.call(D,p),D.color.copy(p.color),p=D}else if(m&&p&&!(p instanceof C)){const D=new C({size:10,sizeAttenuation:!1});Y.prototype.copy.call(D,p),D.color.copy(p.color),D.map=p.map,p=D}}p===void 0&&(u?p=new T:m?p=new C({size:1,sizeAttenuation:!1}):p=new le,p.name=j.name,p.flatShading=!j.smooth,p.vertexColors=g,n.materials[N]=p),y.push(p)}let w;if(y.length>1){for(let b=0,U=a.length;b<U;b++){const j=a[b];h.addGroup(j.groupStart,j.groupCount,b)}u?w=new q(h,y):m?w=new G(h,y):w=new _(h,y)}else u?w=new q(h,y[0]):m?w=new G(h,y[0]):w=new _(h,y[0]);w.name=c.name,s.add(w)}else if(n.vertices.length>0){const l=new C({size:1,sizeAttenuation:!1}),d=new B;d.setAttribute("position",new z(n.vertices,3)),n.colors.length>0&&n.colors[0]!==void 0&&(d.setAttribute("color",new z(n.colors,3)),l.vertexColors=!0);const c=new G(d,l);s.add(c)}return s}}let v,V,I,A,O,L=[],F=[],E=[],P={red:{active:!1,lastHoverEnd:0},blue:{active:!1,lastHoverEnd:0}};function Me(){v=new ce,v.background=new $(0),V=new de(75,window.innerWidth/window.innerHeight,.1,1e3),V.position.z=5,I=new ue({antialias:!0}),I.setSize(window.innerWidth,window.innerHeight),I.setPixelRatio(Math.min(window.devicePixelRatio,2)),document.body.appendChild(I.domElement);const i=new he(16777215,.2);v.add(i);const e=new fe(1117525,1.2);e.position.set(5,5,5),v.add(e),A=new me,O=new pe,Le(),window.addEventListener("resize",Fe),window.addEventListener("mousemove",Ee),window.addEventListener("click",Ve),oe()}function Le(){Pe(),je()}function Pe(){const i=new ee,e=new te;i.load("/models/reddoor.webp",function(n){e.load("/models/reddoor.obj",function(t){t.traverse(function(l){if(l instanceof _){const d=new H({map:n,metalness:.3,roughness:.7,emissive:3346705,emissiveIntensity:.2});l.material=d}});const o=new k().setFromObject(t),s=o.max.y-o.min.y,r=-(o.min.y+s/2);t.position.set(-2.5,r,0),t.scale.set(1,1,1),t.userData={clickable:!0,targetPage:"/pages/MS1.html",originalPosition:new x(-2.5,r,0),hoverEffect:{active:!1,intensity:.05,phase:0},doorType:"red"},v.add(t),L.push(t),console.log("Red door loaded successfully")},function(t){console.log("Loading red door OBJ:",t)},function(t){console.error("Error loading red door OBJ:",t)})},function(n){console.log("Loading red door texture:",n)},function(n){console.warn("Red door texture failed, loading OBJ without texture:",n),e.load("/models/reddoor.obj",function(t){t.traverse(function(l){if(l instanceof _){const d=new H({color:13382451,metalness:.3,roughness:.7,emissive:3346705,emissiveIntensity:.2});l.material=d}});const o=new k().setFromObject(t),s=o.max.y-o.min.y,r=-(o.min.y+s/2);t.position.set(-2.5,r,0),t.userData={clickable:!0,targetPage:"/pages/MS1.html",originalPosition:new x(-2.5,r,0),hoverEffect:{active:!1,intensity:.05,phase:0},doorType:"red"},v.add(t),L.push(t),console.log("Red door loaded without texture")},void 0,function(t){console.error("Failed to load red door OBJ:",t)})})}function je(){const i=new ee,e=new te;i.load("/models/bluedoor.webp",function(n){e.load("/models/bluedoor.obj",function(t){t.traverse(function(l){if(l instanceof _){const d=new H({map:n,metalness:.3,roughness:.7,emissive:2236962,emissiveIntensity:.2});l.material=d}});const o=new k().setFromObject(t),s=o.max.y-o.min.y,r=-(o.min.y+s/2);t.position.set(2.5,r,0),t.scale.set(1,1,1),t.userData={clickable:!0,targetPage:"/pages/SE1.html",originalPosition:new x(2.5,r,0),hoverEffect:{active:!1,intensity:.08,phase:Math.PI/2},doorType:"blue"},v.add(t),L.push(t),console.log("Blue door loaded successfully")},function(t){console.log("Loading blue door OBJ:",t)},function(t){console.error("Error loading blue door OBJ:",t)})},function(n){console.log("Loading blue door texture:",n)},function(n){console.warn("Blue door texture failed, loading OBJ without texture:",n),e.load("/models/bluedoor.obj",function(t){t.traverse(function(l){if(l instanceof _){const d=new H({color:204,metalness:.3,roughness:.7,emissive:51,emissiveIntensity:.2});l.material=d}});const o=new k().setFromObject(t),s=o.max.y-o.min.y,r=-(o.min.y+s/2);t.position.set(2.5,r,0),t.userData={clickable:!0,targetPage:"/pages/SE1.html",originalPosition:new x(2.5,r,0),hoverEffect:{active:!1,intensity:.08,phase:Math.PI/2},doorType:"blue"},v.add(t),L.push(t),console.log("Blue door loaded without texture")},void 0,function(t){console.error("Failed to load blue door OBJ:",t)})})}function W(i,e){const n=[];n.push(new x(e.x,e.y,e.z));const t=.3,o=new x(e.x+(Math.random()*t*2-t),e.y+(Math.random()*t*2-t),e.z+(Math.random()*t*2-t));n.push(o);const s=new B().setFromPoints(n),r=new T({color:i==="red"?9109504:1117525,transparent:!0,opacity:.7}),l=new ge(s,r);v.add(l);const d={points:n,line:l,doorType:i,age:0,maxAge:Math.random()*100+100,growRate:Math.random()*.3+.1};return i==="red"?F.push(d):E.push(d),d}function S(i,e){const n=Math.floor(Math.random()*3)+1;for(let t=0;t<n;t++){const o=new x(e.x+(Math.random()*.6-.3),e.y+(Math.random()*.6-.3),e.z);W(i,o)}}function De(){for(let i=F.length-1;i>=0;i--){const e=F[i];if(e.age++,e.age>e.maxAge){e.line.material.opacity-=.05,e.line.material.opacity<=0&&(v.remove(e.line),F.splice(i,1));continue}if(Math.random()<e.growRate){const n=e.points[e.points.length-1],t=Math.random()*Math.PI*2,o=Math.random()*.2+.05,s=new x(n.x+Math.cos(t)*o,n.y+Math.sin(t)*o,n.z+(Math.random()*.1-.05));e.points.push(s);const r=new B().setFromPoints(e.points);e.line.geometry.dispose(),e.line.geometry=r}if(e.points.length>3&&e.points.length<20&&Math.random()<.03){const n=Math.floor(Math.random()*(e.points.length-2))+1,t=e.points[n];W("red",t.clone())}}for(let i=E.length-1;i>=0;i--){const e=E[i];if(e.age++,e.age>e.maxAge){e.line.material.opacity-=.05,e.line.material.opacity<=0&&(v.remove(e.line),E.splice(i,1));continue}if(Math.random()<e.growRate){const n=e.points[e.points.length-1],t=Math.random()*Math.PI*2,o=Math.random()*.2+.05,s=new x(n.x+Math.cos(t)*o,n.y+Math.sin(t)*o,n.z+(Math.random()*.1-.05));e.points.push(s);const r=new B().setFromPoints(e.points);e.line.geometry.dispose(),e.line.geometry=r}if(e.points.length>3&&e.points.length<20&&Math.random()<.03){const n=Math.floor(Math.random()*(e.points.length-2))+1,t=e.points[n];W("blue",t.clone())}}if(F.length>50){const i=F.length-50;for(let e=0;e<i;e++){const n=F.shift();v.remove(n.line)}}if(E.length>50){const i=E.length-50;for(let e=0;e<i;e++){const n=E.shift();v.remove(n.line)}}}function Fe(){V.aspect=window.innerWidth/window.innerHeight,V.updateProjectionMatrix(),I.setSize(window.innerWidth,window.innerHeight)}function Ee(i){O.x=i.clientX/window.innerWidth*2-1,O.y=-(i.clientY/window.innerHeight)*2+1,A.setFromCamera(O,V);const e=A.intersectObjects(L,!0);let n=!1,t=!1;if(document.body.style.cursor="default",L.forEach(o=>{o.userData.hoverEffect.active=!1}),e.length>0){const o=ne(e[0].object);o&&o.userData&&o.userData.clickable&&(document.body.style.cursor="pointer",o.userData.hoverEffect.active=!0,o.userData.doorType==="red"?(n=!0,Math.random()<.1&&S("red",o.position)):o.userData.doorType==="blue"&&(t=!0,Math.random()<.1&&S("blue",o.position)))}if(n){if(!P.red.active){P.red.active=!0;const o=L.find(s=>s.userData.doorType==="red");o&&S("red",o.position)}}else P.red.active&&(P.red.active=!1,P.red.lastHoverEnd=performance.now());if(t){if(!P.blue.active){P.blue.active=!0;const o=L.find(s=>s.userData.doorType==="blue");o&&S("blue",o.position)}}else P.blue.active&&(P.blue.active=!1,P.blue.lastHoverEnd=performance.now())}function ne(i){let e=i;for(;e;){if(e.userData&&e.userData.clickable)return e;if(!e.parent||e.parent===v)return null;e=e.parent}return null}function Ve(i){A.setFromCamera(O,V);const e=A.intersectObjects(L,!0);if(e.length>0){const n=ne(e[0].object);if(n&&n.userData.clickable&&n.userData.targetPage){const t=document.createElement("div");t.style.position="fixed",t.style.top="0",t.style.left="0",t.style.width="100vw",t.style.height="100vh",t.style.backgroundColor="black",t.style.opacity="0",t.style.transition="opacity 1s ease",t.style.zIndex="1000",document.body.appendChild(t),setTimeout(()=>{t.style.opacity="1",setTimeout(()=>{window.location.href=n.userData.targetPage},1e3)},50)}}}function oe(){requestAnimationFrame(oe);const i=performance.now()*.001;L.forEach(e=>{if(e.userData.hoverEffect.active){const n=e.userData.originalPosition,t=e.userData.hoverEffect.intensity,o=e.userData.hoverEffect.phase;e.position.x=n.x+Math.sin(i*15+o)*t,e.position.y=n.y+Math.sin(i*20)*t,e.position.z=n.z+Math.sin(i*12-o)*t,e.rotation.x=Math.sin(i*10)*.05,e.rotation.y=Math.sin(i*8)*.05}else{const n=e.userData.originalPosition;e.position.lerp(n,.1),e.rotation.x*=.9,e.rotation.y*=.9}}),L.forEach((e,n)=>{e.rotation.y+=.005*(n+1),e.rotation.x+=.002*(n+1)}),De(),I.render(v,V)}window.addEventListener("load",async()=>{Me();const i=new Audio("/sound/mindspacemusic.mp3");i.loop=!0,i.volume=.5;try{await i.play(),console.log("Audio started automatically")}catch{console.log("Autoplay prevented, waiting for user interaction"),document.addEventListener("click",()=>{i.play()},{once:!0})}});
