import{S as $,P as H,W as B,o as O,p as X,m as j,M as D,q,t as I,r as W,w as G,a as y,v as F,G as K,u as v,A as N,D as U}from"./three.module-8Oc40bl9.js";import{C as V,a as J}from"./CSS2DRenderer-C93wpHdk.js";import{D as Q,G as Y}from"./DRACOLoader-LEHEqbdo.js";const S=document.createElement("div");S.style.cssText="position:fixed;top:0;left:0;width:100%;height:100%;background:#000;z-index:9999;transition:opacity 1.5s ease-out";document.body.appendChild(S);const h={promises:[],addPromise(e){const n=e.catch(t=>(console.warn("Asset loading error:",t),null));return this.promises.push(n),n},allLoaded(){return Promise.all(this.promises)}},p=new $,c=new H(75,window.innerWidth/window.innerHeight,.1,1e3),g=new B({antialias:!0});g.setSize(window.innerWidth,window.innerHeight);g.shadowMap.enabled=!0;document.body.appendChild(g.domElement);const C=new O;c.add(C);const x=new X(C);function Z(){return new Promise((e,n)=>{new q().load("/sound/MS6.mp3",o=>{x.setBuffer(o),x.setLoop(!0),x.setVolume(.5),console.log("Audio loaded"),e(o)},o=>console.log(`Audio loading: ${o.loaded/o.total*100}% loaded`),o=>{console.error("Error loading audio:",o),n(o)})})}h.addPromise(Z());const b=new V;b.setSize(window.innerWidth,window.innerHeight);b.domElement.style.cssText="position:absolute;top:0;pointer-events:none";document.body.appendChild(b.domElement);c.position.set(0,5,0);c.lookAt(-10,5,0);const m=20,f=18,E=.5,T=new j,_=new D({color:139,roughness:.7,metalness:.2});let L=_,w;function ee(e){return new Promise((n,t)=>{T.load(e,o=>{console.log(`Texture loaded successfully: ${e}`),o.wrapS=o.wrapT=F,o.repeat.set(1,1),n(o)},o=>console.log(`Texture ${e} loading: ${o.loaded/o.total*100}%`),o=>{console.error(`Error loading texture ${e}:`,o),t(o)})})}function oe(){return new Promise(async e=>{try{const n=await ee("/photos/MSimages/MStexture.png");L=new D({map:n,roughness:.7,metalness:.2}),console.log("Successfully loaded texture"),ae(),e(n)}catch{console.warn("Failed to load texture"),e(null)}})}h.addPromise(oe());function te(e,n,t,o={x:0,y:0,z:0}){return new Promise((s,a)=>{const d=new Q;d.setDecoderPath("https://cdn.jsdelivr.net/npm/three@0.160.0/examples/jsm/libs/draco/");const r=new Y;r.setDRACOLoader(d),r.load(e,i=>{const u=i.scene;u.scale.set(n.x,n.y,n.z),u.position.set(t.x,t.y,t.z),u.rotation.set(o.x,o.y,o.z),u.traverse(l=>{l.isMesh&&(l.castShadow=l.receiveShadow=!0)}),p.add(u),s(u)},i=>console.log(`${e} loading: ${i.loaded/i.total*100}%`),i=>{console.error(`Error loading ${e}:`,i),a(i)})})}h.addPromise(te("/models/MSmodels/MS6.glb",{x:5,y:5,z:5},{x:0,y:.2,z:-10}));function ne(){const e=new K,n=new v(m,E,m),t=new y(n,L);t.position.y=-.5/2,t.receiveShadow=!0,e.add(t);const o=new v(m,f,E),s=new y(o,L);s.position.set(0,f/2,-20/2),s.receiveShadow=s.castShadow=!0,s.userData={wallId:"front"},e.add(s);const a=s.clone();a.position.z=m/2,a.userData={wallId:"back"},e.add(a);const d=new v(E,f,m),r=new y(d,L);r.position.set(-20/2,f/2,0),r.receiveShadow=r.castShadow=!0,r.userData={wallId:"left"},e.add(r);const i=r.clone();i.position.x=m/2,i.userData={wallId:"right"},e.add(i);const u=new N(16777215,.05);e.add(u);const l=new U(16777215,.05);return l.position.set(0,15,0),l.castShadow=!0,l.shadow.mapSize.width=l.shadow.mapSize.height=2048,e.add(l),{group:e,walls:{front:s,back:a,left:r,right:i}}}function ae(){w&&(w.group.children.forEach(e=>{e.isMesh&&(e.material=L)}),g.render(p,c))}function se(){return new Promise((e,n)=>{T.load("/photos/endbutton.png",t=>{const o=new I(10,10),s=new W({map:t,transparent:!0,opacity:.5,side:G}),a=new y(o,s);a.position.set(0,f/2-4,m/2-.5),a.rotation.y=Math.PI,p.add(a),e(a)},void 0,t=>{console.error("Error loading back wall image:",t),n(t)})})}h.addPromise(se());function M(e,n){const t=document.createElement("div");t.className="wall-text",t.style.cssText="width:1000px;padding:20px;color:white;border-radius:10px;font-family:Arial,sans-serif;font-size:25px;pointer-events:auto",t.innerHTML=n,setTimeout(()=>{t.querySelectorAll("a").forEach(d=>{d.style.cssText="color:#0808fc;text-decoration:none;cursor:pointer",d.addEventListener("click",r=>{console.log(`Link clicked: ${d.getAttribute("href")}`),console.log(`Link text: ${d.textContent}`)})})},100);const o=new J(t);switch(e.userData.wallId){case"front":o.position.set(0,0,.1);break;case"back":o.position.set(-7,-2,-.1);break;case"left":o.position.set(.1,0,0),o.rotation.y=Math.PI/2;break;case"right":o.position.set(-.1,0,0),o.rotation.y=-Math.PI/2;break}return e.add(o),o}function ie(){return new Promise((e,n)=>{T.load("/photos/MSimages/MS6.webp",t=>{const o=new I(15,10),s=new W({map:t,transparent:!0,opacity:.5,side:G}),a=new y(o,s);a.position.set(-20/2+.8,f/2-3,0),a.rotation.y=Math.PI/2,p.add(a),e(a)},void 0,t=>{console.error("Error loading left wall image:",t),n(t)})})}h.addPromise(ie());let P=!1,k=!1,A=0;const re=.01;document.addEventListener("keydown",e=>{e.key==="Alt"&&(P=!0)});document.addEventListener("keyup",e=>{e.key==="Alt"&&(P=!1,k=!1)});document.addEventListener("mousedown",e=>{P&&(k=!0,A=e.clientX)});document.addEventListener("mouseup",()=>k=!1);document.addEventListener("mousemove",e=>{if(k&&P){const n=e.clientX-A;c.rotation.y+=n*re,A=e.clientX}});window.addEventListener("resize",()=>{c.aspect=window.innerWidth/window.innerHeight,c.updateProjectionMatrix(),g.setSize(window.innerWidth,window.innerHeight),b.setSize(window.innerWidth,window.innerHeight)});function R(){requestAnimationFrame(R),g.render(p,c),b.render(p,c)}async function z(){try{await h.allLoaded(),w=ne(),p.add(w.group),M(w.walls.front,`
            <p>I waited till the dr▆kards had flo▆▆ out of my place, stumbling off into the
            dark streets. Their memories are f▆tered with black spots from the d▆▆ wine 
            they were so excit▆ to sip.
            </p>
        `),M(w.walls.right,`
            <p>G▆ on the move fa▆. 
            ▆▆▆ shou▆ be done with it?
            ▆▆ light a fi▆ and ▆rn it ▆▆ dust.
            A ▆▆ of ▆drofl▆ic ac▆ can me▆ it all aw▆.
            Disapp▆r?
            I can't hi▆ what's been ▆▆.
            I don't want to.
            I'm going to sh▆ it and ▆▆▆ his wor▆ crumble to p▆ces. 
            </p>
        `),M(w.walls.back,'<p><a href="MSending.html">WAKE UP</a></p>'),M(w.walls.back,"<p>.-- .- -.- . / ..-</p>"),R(),x.buffer&&x.play(),setTimeout(()=>{S.style.opacity="0",setTimeout(()=>S.style.display="none",5e3)},5e3)}catch(e){console.error("Error initializing scene:",e),S.style.display="none"}}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",z):z();
